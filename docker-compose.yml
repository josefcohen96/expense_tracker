services:
  web:
    build: .
    container_name: expense_tracker
    ports:
      - "8080:8080"
    volumes:
      # Persist the sqlite database
      # logical path maps to: /app/app/backend/data
      - expense_data:/app/app/backend/data
    environment:
      # Ensure we use production settings
      - ENVIRONMENT=production
      - RAILWAY_ENVIRONMENT=true 
      # (Using RAILWAY_ENVIRONMENT=true temporarily to trigger the 'production' logic in main.py 
      #  until we refactor main.py to be platform-agnostic, though ENVIRONMENT=production should work too 
      #  if main.py logic is checked carefully. main.py checks RAILWAY_ENVIRONMENT is not None OR ENVIRONMENT==production)
      - PORT=8080
    restart: unless-stopped

volumes:
  expense_data: